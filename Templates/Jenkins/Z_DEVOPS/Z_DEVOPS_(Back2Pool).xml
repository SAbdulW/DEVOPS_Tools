<?xml version='1.0' encoding='UTF-8'?>
<project>
  <actions/>
  <description></description>
  <keepDependencies>false</keepDependencies>
  <properties>
    <hudson.plugins.buildblocker.BuildBlockerProperty plugin="build-blocker-plugin@1.4.1">
      <useBuildBlocker>false</useBuildBlocker>
    </hudson.plugins.buildblocker.BuildBlockerProperty>
    <hudson.model.ParametersDefinitionProperty>
      <parameterDefinitions>
        <hudson.model.StringParameterDefinition>
          <name>TestEnvFolderPath</name>
          <description>&quot;Test bench Pool Path&quot; - A path that indicates where the environments are located in the Vcenter</description>
          <defaultValue>Automation/CI/11.2SP1Latest-Greatst</defaultValue>
        </hudson.model.StringParameterDefinition>
        <hudson.model.StringParameterDefinition>
          <name>PendingFolderPath</name>
          <description>“Running Environment Pool Path” - A path that indicates where to move the fetched folder in the Vcenter</description>
          <defaultValue>Automation/CI/11.2SP1Latest-Running</defaultValue>
        </hudson.model.StringParameterDefinition>
        <hudson.model.StringParameterDefinition>
          <name>Snapshot</name>
          <description>Base Snapshot to revert the machine.</description>
          <defaultValue>Base</defaultValue>
        </hudson.model.StringParameterDefinition>
        <hudson.model.StringParameterDefinition>
          <name>Test_Machine_Name</name>
          <description></description>
          <defaultValue></defaultValue>
        </hudson.model.StringParameterDefinition>
        <hudson.model.StringParameterDefinition>
          <name>ProvisioningRoot</name>
          <description></description>
          <defaultValue></defaultValue>
        </hudson.model.StringParameterDefinition>
        <hudson.model.BooleanParameterDefinition>
          <name>KeepTheFixtureWhenDone</name>
          <description>If this option is checked, the machine will not be reverted back and can be used for the developer investigation. The IP of the machine can be taken from the log. When you finish using the machine , turn it off.</description>
          <defaultValue>false</defaultValue>
        </hudson.model.BooleanParameterDefinition>
        <hudson.model.StringParameterDefinition>
          <name>ParkingPool</name>
          <description>Pool Folder that has the env for investigation  </description>
          <defaultValue></defaultValue>
        </hudson.model.StringParameterDefinition>
      </parameterDefinitions>
    </hudson.model.ParametersDefinitionProperty>
  </properties>
  <scm class="hudson.scm.NullSCM"/>
  <assignedNode>Slave-B-Staging01</assignedNode>
  <canRoam>false</canRoam>
  <disabled>false</disabled>
  <blockBuildWhenDownstreamBuilding>false</blockBuildWhenDownstreamBuilding>
  <blockBuildWhenUpstreamBuilding>false</blockBuildWhenUpstreamBuilding>
  <triggers/>
  <concurrentBuild>false</concurrentBuild>
  <builders>
    <hudson.tasks.BatchFile>
      <command>echo KeepTheFixtureWhenDone=%KeepTheFixtureWhenDone%&#xd;
echo TestEnvFolderPath=%TestEnvFolderPath% and PendingFolderPath=&quot;%PendingFolderPath%&quot;&#xd;
echo ProvisioningRoot=%ProvisioningRoot%</command>
    </hudson.tasks.BatchFile>
    <org.jenkinsci.plugins.vsphere.VSphereBuildStepContainer plugin="vsphere-cloud@1.1.13-SNAPSHOT">
      <buildStep class="org.jenkinsci.plugins.vsphere.builders.GetFolderInfo">
        <sourceName>${TestEnvFolderPath}</sourceName>
        <numberVM>0</numberVM>
        <numberFolder>0</numberFolder>
      </buildStep>
      <serverName>ATL Vsphere Server</serverName>
      <serverHash>-1412856745</serverHash>
    </org.jenkinsci.plugins.vsphere.VSphereBuildStepContainer>
    <org.jenkinsci.plugins.conditionalbuildstep.ConditionalBuilder plugin="conditional-buildstep@1.3.3">
      <runner class="org.jenkins_ci.plugins.run_condition.BuildStepRunner$Fail" plugin="run-condition@1.0"/>
      <runCondition class="org.jenkins_ci.plugins.run_condition.core.StringsMatchCondition" plugin="run-condition@1.0">
        <arg1>$KeepTheFixtureWhenDone</arg1>
        <arg2>true</arg2>
        <ignoreCase>false</ignoreCase>
      </runCondition>
      <conditionalbuilders>
        <hudson.tasks.BatchFile>
          <command>echo TIMESTAMP=%DATE:/=-%_%TIME::=-% &#xd;
set TIMESTAMP=%date%_%time%&#xd;
set TIMESTAMP=%TIMESTAMP: =_%&#xd;
set TIMESTAMP=%TIMESTAMP::=%&#xd;
set TIMESTAMP=%TIMESTAMP:/=_%&#xd;
set TIMESTAMP=%TIMESTAMP:.=_%&#xd;
&#xd;
echo TIMESTAMP=%TIMESTAMP% &gt;%WORKSPACE%\timestamp.prop&#xd;
</command>
        </hudson.tasks.BatchFile>
        <EnvInjectBuilder plugin="envinject@1.90">
          <info>
            <propertiesFilePath>$WORKSPACE\timestamp.prop</propertiesFilePath>
          </info>
        </EnvInjectBuilder>
        <org.jenkinsci.plugins.vsphere.VSphereBuildStepContainer plugin="vsphere-cloud@1.1.13-SNAPSHOT">
          <buildStep class="org.jenkinsci.plugins.vsphere.builders.Rename">
            <oldName>${FIRST_VM}</oldName>
            <newName>${TIMESTAMP}_${BUILD_TAG}</newName>
          </buildStep>
          <serverName>ATL Vsphere Server</serverName>
          <serverHash>-1412856745</serverHash>
        </org.jenkinsci.plugins.vsphere.VSphereBuildStepContainer>
        <org.jenkinsci.plugins.vsphere.VSphereBuildStepContainer plugin="vsphere-cloud@1.1.13-SNAPSHOT">
          <buildStep class="org.jenkinsci.plugins.vsphere.builders.Move">
            <sourceName>${TestEnvFolderPath}</sourceName>
            <location>$ProvisioningRoot/Parking/</location>
          </buildStep>
          <serverName>ATL Vsphere Server</serverName>
          <serverHash>-1412856745</serverHash>
        </org.jenkinsci.plugins.vsphere.VSphereBuildStepContainer>
        <hudson.tasks.BatchFile>
          <command>echo TestEnvFolderPath=%TestEnvFolderPath%  was  moved to %ProvisioningRoot%/Parking&#xd;
echo DestPool=%ProvisioningRoot%/Parking &gt;%WORKSPACE%\backtoPool.prop</command>
        </hudson.tasks.BatchFile>

      </conditionalbuilders>
    </org.jenkinsci.plugins.conditionalbuildstep.ConditionalBuilder>
    <org.jenkinsci.plugins.conditionalbuildstep.ConditionalBuilder plugin="conditional-buildstep@1.3.3">
      <runner class="org.jenkins_ci.plugins.run_condition.BuildStepRunner$Fail" plugin="run-condition@1.0"/>
      <runCondition class="org.jenkins_ci.plugins.run_condition.core.StringsMatchCondition" plugin="run-condition@1.0">
        <arg1>$KeepTheFixtureWhenDone</arg1>
        <arg2>false</arg2>
        <ignoreCase>false</ignoreCase>
      </runCondition>
      <conditionalbuilders>
        <org.jenkinsci.plugins.vsphere.VSphereBuildStepContainer plugin="vsphere-cloud@1.1.13-SNAPSHOT">
          <buildStep class="org.jenkinsci.plugins.vsphere.builders.RevertToSnapshot">
            <vm>${FIRST_VM}</vm>
            <snapshotName>${Snapshot}</snapshotName>
          </buildStep>
          <serverName>ATL Vsphere Server</serverName>
          <serverHash>-1412856745</serverHash>
        </org.jenkinsci.plugins.vsphere.VSphereBuildStepContainer>
        <org.jenkinsci.plugins.vsphere.VSphereBuildStepContainer plugin="vsphere-cloud@1.1.13-SNAPSHOT">
          <buildStep class="org.jenkinsci.plugins.vsphere.builders.PowerOn">
            <vm>${FIRST_VM}</vm>
            <timeoutInSeconds>180</timeoutInSeconds>
          </buildStep>
          <serverName>ATL Vsphere Server</serverName>
          <serverHash>-1412856745</serverHash>
        </org.jenkinsci.plugins.vsphere.VSphereBuildStepContainer>
        <org.jenkinsci.plugins.vsphere.VSphereBuildStepContainer plugin="vsphere-cloud@1.1.13-SNAPSHOT">
          <buildStep class="org.jenkinsci.plugins.vsphere.builders.Move">
            <sourceName>${TestEnvFolderPath}</sourceName>
            <location>${PendingFolderPath}</location>
          </buildStep>
          <serverName>ATL Vsphere Server</serverName>
          <serverHash>-1412856745</serverHash>
        </org.jenkinsci.plugins.vsphere.VSphereBuildStepContainer>
        <hudson.tasks.BatchFile>
          <command>echo TestEnvFolderPath=%TestEnvFolderPath%  was reverted back to %Snapshot% and moved to %PendingFolderPath%&#xd;
echo DestPool=%PendingFolderPath% &gt;%WORKSPACE%\backtoPool.prop</command>
        </hudson.tasks.BatchFile>
      </conditionalbuilders>
    </org.jenkinsci.plugins.conditionalbuildstep.ConditionalBuilder>
    <EnvInjectBuilder plugin="envinject@1.90">
      <info>
        <propertiesFilePath>${WORKSPACE}\backtoPool.prop</propertiesFilePath>
      </info>
    </EnvInjectBuilder>
  </builders>
  <publishers>
    <hudson.plugins.emailext.ExtendedEmailPublisher plugin="email-ext@2.39">
      <recipientList>$DEFAULT_RECIPIENTS</recipientList>
      <configuredTriggers>
        <hudson.plugins.emailext.plugins.trigger.FailureTrigger>
          <email>
            <recipientList></recipientList>
            <subject>$PROJECT_DEFAULT_SUBJECT</subject>
            <body>$PROJECT_DEFAULT_CONTENT</body>
            <recipientProviders>
              <hudson.plugins.emailext.plugins.recipients.ListRecipientProvider/>
            </recipientProviders>
            <attachmentsPattern></attachmentsPattern>
            <attachBuildLog>false</attachBuildLog>
            <compressBuildLog>false</compressBuildLog>
            <replyTo>$PROJECT_DEFAULT_REPLYTO</replyTo>
            <contentType>project</contentType>
          </email>
        </hudson.plugins.emailext.plugins.trigger.FailureTrigger>
      </configuredTriggers>
      <contentType>default</contentType>
      <defaultSubject>$DEFAULT_SUBJECT</defaultSubject>
      <defaultContent>Created by $jenkins-ForRonDEVOPS_(Back2Pool)-10  Job
URL=$BUILD_URL
Provisioning IP = $VmIp
${TestEnvFolderPath} Environment was moved to ${DestPool}</defaultContent>
      <attachmentsPattern></attachmentsPattern>
      <presendScript>$DEFAULT_PRESEND_SCRIPT</presendScript>
      <attachBuildLog>false</attachBuildLog>
      <compressBuildLog>false</compressBuildLog>
      <replyTo>$DEFAULT_REPLYTO</replyTo>
      <saveOutput>false</saveOutput>
      <disabled>false</disabled>
    </hudson.plugins.emailext.ExtendedEmailPublisher>
  </publishers>
  <buildWrappers>
    <org.jvnet.hudson.tools.versionnumber.VersionNumberBuilder plugin="versionnumber@1.4.1">
      <versionNumberString>${MasterBuildVersion}</versionNumberString>
      <projectStartDate>1969-12-31 05:00:00.0 UTC</projectStartDate>
      <environmentVariableName>MasterBuildVersion</environmentVariableName>
      <oBuildsToday>-1</oBuildsToday>
      <oBuildsThisMonth>-1</oBuildsThisMonth>
      <oBuildsThisYear>-1</oBuildsThisYear>
      <oBuildsAllTime>-1</oBuildsAllTime>
      <skipFailedBuilds>false</skipFailedBuilds>
      <useAsBuildDisplayName>true</useAsBuildDisplayName>
    </org.jvnet.hudson.tools.versionnumber.VersionNumberBuilder>
  </buildWrappers>
</project>